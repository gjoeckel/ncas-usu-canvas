CANVAS INTERCEPTOR - SETUP CHECKLIST
====================================

Print this out or keep it open while setting up!

PREREQUISITES:
â–¡ Node.js installed
â–¡ npm installed  
â–¡ Chrome browser
â–¡ Canvas course page URL ready
â–¡ Local CSS/JS files created

PART 1: SERVER SETUP
--------------------
â–¡ Navigate to canvas-interceptor-mcp directory
â–¡ Run: npm install
â–¡ Open file-mappings.json
â–¡ Update URLs to match YOUR Canvas attachment URLs
    How: Open Canvas page > DevTools > Network > Find your files
â–¡ Update localPath to point to YOUR local files
    Example: "../projects/NCAS/NCAS1/ncas2.css"
â–¡ Verify local files exist at those paths
â–¡ Run: npm start
â–¡ See "Server running on: http://localhost:3000"
â–¡ Test health endpoint:
    curl http://localhost:3000/health
    OR visit: http://localhost:3000/health in browser
â–¡ Should see: {"status":"ok",...}

PART 2: EXTENSION SETUP  
-----------------------
â–¡ Create new folder: canvas-interceptor-extension
â–¡ Copy these files from outputs folder into extension folder:
    â–¡ manifest.json
    â–¡ rules.json
    â–¡ background.js
    â–¡ popup.html
    â–¡ popup.js
â–¡ Generate icons:
    Option A: Run create-icons.sh (requires ImageMagick)
    Option B: Use online SVG to PNG converter with icon.svg
    Option C: Create any 16x16, 48x48, 128x128 PNG images
â–¡ Copy icon files to extension folder:
    â–¡ icon16.png
    â–¡ icon48.png
    â–¡ icon128.png

PART 3: SYNC RULES WITH MAPPINGS
---------------------------------
â–¡ From canvas-interceptor-mcp directory, run:
    node generate-rules.js
â–¡ Copy the generated rules.json to extension folder
    (Overwrites the template rules.json)
â–¡ Open rules.json and verify:
    â–¡ URLs match YOUR Canvas URLs
    â–¡ Redirect URLs point to localhost:3000

PART 4: INSTALL EXTENSION
-------------------------
â–¡ Open Chrome
â–¡ Go to: chrome://extensions/
â–¡ Enable "Developer mode" (toggle in top right)
â–¡ Click "Load unpacked"
â–¡ Select your canvas-interceptor-extension folder
â–¡ Extension appears in toolbar
â–¡ Click extension icon
â–¡ See green "âœ“ Server running" status
    If red "âœ— Server offline":
    â†’ Go back to Part 1, ensure server is running

PART 5: CONFIGURE CANVAS FOR TESTING
------------------------------------
â–¡ Open your Canvas course page
â–¡ Open DevTools: F12
â–¡ Go to Network tab
â–¡ Check "Disable cache" checkbox
â–¡ Keep DevTools open

PART 6: TEST INTERCEPTION
-------------------------
â–¡ Hard reload Canvas page: Ctrl+Shift+R (Windows) or Cmd+Shift+R (Mac)
â–¡ In Network tab, filter by your filename (e.g., "ncas1")
â–¡ Click on your CSS file
â–¡ Check "Request URL":
    Should start with "http://localhost:3000"
â–¡ Check "Response Headers":
    Should include "x-intercepted-by: Canvas-MCP-Interceptor"
â–¡ Go back to server console
â–¡ Should see lines like:
    [INTERCEPTED] https://instructure-uploads.s3.amazonaws.com/...
    [SERVED] /path/to/your/local/file.css

PART 7: VERIFY LOCAL FILES ARE LOADING
--------------------------------------
â–¡ Add a unique comment to top of your local CSS file:
    /* TESTING LOCAL VERSION 123 */
â–¡ Save the file
â–¡ Server console shows: [FILE CHANGED]
â–¡ Hard reload Canvas: Ctrl+Shift+R
â–¡ In DevTools, click your CSS file
â–¡ Click "Response" tab
â–¡ See your unique comment at the top
    If you see it: SUCCESS! âœ“
    If you don't see it: See TROUBLESHOOTING section

TROUBLESHOOTING FAILURES:
------------------------

Extension shows "Server offline":
â–¡ Ensure npm start is running
â–¡ Check http://localhost:3000/health in browser
â–¡ Restart server if needed

Files loading from S3 instead of localhost:
â–¡ Hard reload: Ctrl+Shift+R (NOT regular F5)
â–¡ Ensure "Disable cache" is checked in DevTools
â–¡ Click extension icon > "Clear Canvas Cache"
â–¡ Reload extension: chrome://extensions/ > reload icon
â–¡ Check that URLs in rules.json exactly match Network tab URLs

Server shows 404 errors:
â–¡ Check file paths in file-mappings.json
â–¡ Use absolute paths or correct relative paths
â–¡ Verify files exist: ls -la /path/to/your/files

Extension never triggers:
â–¡ Open chrome://extensions/
â–¡ Click "service worker" under Canvas Interceptor
â–¡ Should see log messages
â–¡ If console empty, extension isn't loading
â–¡ Try removing and reinstalling extension

Still not working:
â–¡ Read TROUBLESHOOTING.txt (comprehensive guide)
â–¡ Use curl to test server directly:
    curl "http://localhost:3000/?url=YOUR_FULL_CANVAS_URL"
â–¡ Try DevTools Local Overrides method (see README.md)

SUCCESS INDICATORS:
------------------

You've succeeded when ALL of these are true:
âœ“ Server console shows [INTERCEPTED] messages
âœ“ Network tab shows requests to localhost:3000
âœ“ Response headers include X-Intercepted-By
âœ“ Your local file content appears in Response tab
âœ“ Changes to local files appear after hard reload
âœ“ Extension popup shows green "Server running"

DAILY USE (After Setup):
------------------------
â–¡ Start server: npm start
â–¡ Edit local files
â–¡ Save changes
â–¡ Hard reload Canvas: Ctrl+Shift+R
â–¡ See changes instantly

Need to update URLs or paths?
â–¡ Update file-mappings.json
â–¡ Run: node generate-rules.js
â–¡ Copy new rules.json to extension folder
â–¡ Reload extension in chrome://extensions/
â–¡ Hard reload Canvas page

COMPLETION:
----------
If you checked all boxes and see success indicators, you're done!
Your Canvas development environment is now set up.

If not, see TROUBLESHOOTING.txt for detailed help.

Happy developing! ðŸŽ‰
